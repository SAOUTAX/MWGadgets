{"version":3,"file":"InPageEditSummary.min.js","mappings":"AAAAA,GAAGC,KAAK,cAAcC,IAEtB,WACqB,IAAIC,iBAAiB,KAClC,MAAMC,EAASC,EAAE,4BACXC,EAASD,EAAE,gBAEbD,EAAOG,QAAUD,EAAOC,SAAWH,EAAOI,KAAK,cAAcD,QAWzE,SAAoBH,EAAQE,GACxB,MAAMG,EAAOJ,EAAE,QAAS,CAAEK,GAAI,YAAaC,KAAM,WACjDP,EAAOQ,MAAMH,GAERI,MAAMC,QAAQC,aAInBA,WAAWC,QAAQ,CAACC,EAAMC,KACtB,MAAMC,EAA8B,iBAATF,EACrB,CAAEG,QAASH,EAAMI,MAAOJ,GACxB,CAAEG,QAASH,EAAKG,SAAWH,EAAKI,OAAS,GAAIA,MAAOJ,EAAKI,OAASJ,EAAKG,SAAW,IAElFE,EAAOjB,EAAE,MAAO,CAClBkB,KAAM,IACNZ,KAAMQ,EAAYE,MAClBG,MAAOL,EAAYC,UACpBK,GAAG,QAASC,IACXA,EAAEC,iBACFrB,EAAOsB,IAQnB,SAAuBC,EAASlB,GAC5B,MAAMmB,EAAUD,EAAQE,MAAM,iBAC9B,GAAID,EAAS,CACT,MAAME,EAAMF,EAAQG,MAAQH,EAAQ,GAAGvB,OACvC,MAAO,GAAGsB,EAAQK,MAAM,EAAGF,MAAQrB,IAAOkB,EAAQK,MAAMF,IAC5D,CAEA,MAAMG,EAASN,EAAQO,QAAQ,MAC/B,OAAgB,IAAZD,EACO,GAAGN,EAAQK,MAAM,EAAGC,GAAQE,QAAQ,OAAQ,OAAO1B,KAAQkB,EAAQK,MAAMC,KAG7EN,IAAY,MAAMS,KAAKT,GAAW,GAAGA,KAAWlB,IAAS,GAAGkB,GAAW,KAAKlB,GACvF,CArBuB4B,CAAcjC,EAAOsB,OAAS,GAAIT,EAAYC,UAAUoB,UAGvE/B,EAAKgC,OAAOnB,GACRJ,EAAIH,WAAWR,OAAS,GAAGE,EAAKgC,OAAO,QAEnD,CAnCYC,CAAWtC,EAAQE,KAIlBqC,QAAQC,SAASC,KAAM,CAC5BC,WAAW,EACXC,SAAS,GAEjB,GA4CAC,OAAOjC,WAAaiC,OAAOjC,YAAc,CACrC,OACA,OACA,OACA,KACA,OACA,KACA,MACA","sources":["webpack://mwgadgets/./src/InPageEditSummary/index.js"],"sourcesContent":["mw.hook(\"InPageEdit\").add(IPEQuickSummary);\r\n\r\nfunction IPEQuickSummary() {\r\n    const observer = new MutationObserver(() => {\r\n        const $label = $(\"label[for='editSummary']\");\r\n        const $input = $(\"#editSummary\");\r\n\r\n        if ($label.length && $input.length && !$label.next(\"#mysummary\").length) {\r\n            summaryBox($label, $input);\r\n        }\r\n    });\r\n\r\n    observer.observe(document.body, {\r\n        childList: true,\r\n        subtree: true\r\n    });\r\n}\r\n\r\nfunction summaryBox($label, $input) {\r\n    const $box = $(\"<div>\", { id: \"mysummary\", text: \"自定义摘要：\" });\r\n    $label.after($box);\r\n\r\n    if (!Array.isArray(IPESummary)) {\r\n        return;\r\n    }\r\n\r\n    IPESummary.forEach((item, i) => {\r\n        const summaryItem = typeof item === \"string\" \r\n            ? { summary: item, label: item } \r\n            : { summary: item.summary || item.label || \"\", label: item.label || item.summary || \"\" };\r\n\r\n        const $btn = $(\"<a>\", {\r\n            href: \"#\",\r\n            text: summaryItem.label,\r\n            title: summaryItem.summary\r\n        }).on(\"click\", e => {\r\n            e.preventDefault();\r\n            $input.val(insertSummary($input.val() || \"\", summaryItem.summary)).focus();\r\n        });\r\n\r\n        $box.append($btn);\r\n        if (i < IPESummary.length - 1) $box.append(\" | \");\r\n    });\r\n}\r\n\r\nfunction insertSummary(current, text) {\r\n    const section = current.match(/(\\/\\*.*?\\*\\/)/);\r\n    if (section) {\r\n        const pos = section.index + section[0].length;\r\n        return `${current.slice(0, pos)} ${text}${current.slice(pos)}`;\r\n    }\r\n\r\n    const viaIPE = current.indexOf(\"//\");\r\n    if (viaIPE !== -1) {\r\n        return `${current.slice(0, viaIPE).replace(/\\s*$/, \" \")}${text} ${current.slice(viaIPE)}`;\r\n    }\r\n\r\n    return current && !/\\s$/.test(current) ? `${current} ${text}` : `${current || \"\"}${text}`;\r\n}\r\n\r\nwindow.IPESummary = window.IPESummary || [\r\n    '修饰语句',\r\n    '修正笔误',\r\n    '内容扩充',\r\n    '排版',\r\n    '内部链接',\r\n    '分类',\r\n    '消歧义',\r\n    '萌百化',\r\n  ];"],"names":["mw","hook","add","MutationObserver","$label","$","$input","length","next","$box","id","text","after","Array","isArray","IPESummary","forEach","item","i","summaryItem","summary","label","$btn","href","title","on","e","preventDefault","val","current","section","match","pos","index","slice","viaIPE","indexOf","replace","test","insertSummary","focus","append","summaryBox","observe","document","body","childList","subtree","window"],"sourceRoot":""}